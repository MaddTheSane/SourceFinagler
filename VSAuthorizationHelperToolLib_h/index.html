<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html><head>
    <title>VSAuthorizationHelperToolLib</title>
	<meta http-equiv="Content-Type" content="text/html; charset=ascii" />
 <meta name="generator" content="HeaderDoc" />
<meta name="xcode-display" content="render" />
<style><!--
#tocMenu {
		display: block;
		position:fixed;
		top:0px;
		left:0px;
		width:210px;
		height:100%;
		background:transparent;
}
#bodyText {
		margin-left: 210px;
}
--></style>
<script language="JavaScript" type="text/javascript"><!--
function hidetoc() {
	var origURL = parent.document.URL;
	var contentURL = origURL.substring(origURL.indexOf('?')+1, origURL.length);
	if (contentURL.length == origURL.length) {
		jumpPos = origURL.substring(origURL.indexOf('#')+1, origURL.length);
	}
	if (contentURL == "hidetoc") {
		var toc = document.getElementById('tocMenu');
		var body = document.getElementById('bodyText');
		if (toc && body) {
			toc.style.display = 'none';
			body.style.marginLeft = '0px';
		}
	}
}
--></script>
<style type="text/css"><!--.keyword {background:#ffffff; color:#761550;}.template {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.function {background:#ffffff; color:#000000;}.string {background: #ffffff; color:#891315;}.preprocessor {background:#ffffff; color:#236e25}.comment {background:#ffffff; color:#236e25}.char {background: #ffffff; color:#0000ff;}.var {background:#ffffff; color:#000000;}.type {background:#ffffff; color:#761550;}.param {background:#ffffff; color:#000000;}a:link {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #0000ff;}a:visited {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #0000ff;}a:visited:hover {text-decoration: underline; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #ff6600;}a:active {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #ff6600;}a:hover {text-decoration: underline; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: small; color: #ff6600;}h4 {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: tiny; font-weight: bold;}body {text-decoration: none; font-family: lucida grande, geneva, helvetica, arial, sans-serif; font-size: 10pt;}.list_indent { margin-left: 40px; }.declaration_indent { margin-left: 40px; }.param_indent { margin-left: 40px; }.group_indent { margin-left: 40px; }.group_desc_indent { margin-left: 20px; }.warning_indent { margin-left: 40px; }.important_indent { margin-left: 40px; }.hd_tocAccess { font-style: italic; font-size: 10px; font-weight: normal; color: #303030; }--></style></head><body bgcolor="#ffffff" onload="hidetoc();">
</div>
<!-- headerDoc=Header;  uid=//apple_ref/doc/header/VSAuthorizationHelperToolLib.h;   name=VSAuthorizationHelperToolLib -->
<a name="//apple_ref/doc/header/VSAuthorizationHelperToolLib.h"></a>
<div id='tocMenu'>
<iframe id='toc_content' name='toc_content' SRC='toc.html' width='210' height='100%' align='left' frameborder='0'>This document set is best viewed in a browser that supports iFrames.</iframe>
</div>
<div id='bodyText'>
<a name="top"></a>
<hr><table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h1><a name="VSAuthorizationHelperToolLib">VSAuthorizationHelperToolLib</a></h1>
</td></tr></table><hr><p><!-- begin abstract --><p>Reusable library for creating helper tools that perform privileged 
operations on behalf of your application.
</p>
<!-- end abstract --></p>
<p></p><dl><b>Includes:</b> <!-- a logicalPath="//apple_ref/doc/header/CoreFoundation.h" -->&lt;CoreFoundation/CoreFoundation.h&gt;<!-- /a -->,
<!-- a logicalPath="//apple_ref/doc/header/Security.h" -->&lt;Security/Security.h&gt;<!-- /a -->,
<!-- a logicalPath="//apple_ref/doc/header/asl.h" -->&lt;asl.h&gt;<!-- /a --><br>
</dl><div class='declaration_indent'>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>VSAuthorizationHelperToolLib allows you to perform privileged operations 
in a helper tool. In this model, your application runs with standard 
privileges and, when it needs to do a privileged operation, it makes a 
request to the helper tool.  The helper tool uses Authorization Services 
to ensure that the user is authorized to perform that operation.
</p>
<p>VSAuthorizationHelperToolLib takes care of all of the mechanics of 
installing the helper tool and communicating with it.  Specifically, it 
has routines that your application can call to:
</p>
<p>1. send requests to a helper tool (VSExecuteRequestInHelperTool) 
</p>
<p>2. install the helper tool if it's not installed, or fix an installation if 
it's broken (VSDiagnoseFailure and VSFixFailure)
</p>
<p>VSAuthorizationHelperToolLib also helps you implement the helper tool.  
Specifically, you call the routine VSHelperToolMain in the main entry 
point for your helper tool, passing it an array of command callbacks (of 
type VSCommandProc).  VSHelperToolMain will take care of all the details 
of communication with the application and only call your callback to 
execute the actual command.
</p>
<p>A command consists of request and response CFDictionaries (or, equivalently, 
NSDictionaries).  VSAuthorizationHelperToolLib defines three special keys for 
these dictionaries:
</p>
<p>1. kVSCommandKey -- In the request dictionary, this is the name of the 
command. Its value is a string that uniquely identifies the command within 
your program.
</p>
<p>2. kVSErrorKey -- In the response dictionary, this is the error result for 
the request. Its value is an OSStatus-style error code.
</p>
<p>3. kVSDescriptorArrayKey -- In the response dictionary, if present, this is 
an array of file descriptors being returned from the helper tool.
</p>
<p>You can use any other key to represent addition parameters (or return values) 
for the command.  The only constraints that VSAuthorizationHelperToolLib applies 
to these extra parameters is that they must be serialisable as a CFPropertyList.
</p>
<p>VSAuthorizationHelperToolLib requires that you tell it about the list of commands 
that you support.  Each command is represented by a command specification 
(VSCommandSpec).  The command specification includes the following information:
</p>
<p>1. The name of the command.  This is the same as the kVSCommandKey value in 
the request dictionary.
</p>
<p>2. The authorization right associated with the command.  VSAuthorizationHelperToolLib 
uses this to ensure that the user is authorized to use the command before 
it calls your command callback in the privileged helper tool.
</p>
<p>3. Information to create the command's authorization right specification in the 
policy database.  The is used by the VSSetDefaultRules function.
</p>
<p>Finally, VSAuthorizationHelperToolLib includes a number of utilities routines to help 
wrangle error codes (VSErrnoToOSStatus, VSOSStatusToErrno, and VSGetErrorFromResponse) 
and file descriptors (VSCloseDescriptorArray).
<!-- end discussion -->
<p></p><hr><br><a name='HeaderDoc_groups'><h2>Groups</h2></a>

<h3>Helper Tool Routines</h3>
<div class='group_desc_indent'>
<p> </p></div>
<h4>Group members:</h4>
<div class='group_indent'>
<dl>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSHelperToolMain" target="_top" -->VSHelperToolMain<!-- /a --></tt></dt>
<dd><p>Entry point for a privileged helper tool.
</p>
</dd>
</dl>
</div>
<p>&nbsp;</p>
<h3>Application Routines</h3>
<div class='group_desc_indent'>
<p> </p></div>
<h4>Group members:</h4>
<div class='group_indent'>
<dl>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSDiagnoseFailure" target="_top" -->VSDiagnoseFailure<!-- /a --></tt></dt>
<dd><p>Determines the cause of a failed request.
</p>
</dd>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSExecuteRequestInHelperTool" target="_top" -->VSExecuteRequestInHelperTool<!-- /a --></tt></dt>
<dd><p>Executes a request in the privileged helper tool, returning the response.
</p>
</dd>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSFixFailure" target="_top" -->VSFixFailure<!-- /a --></tt></dt>
<dd><p>Installs, or reinstalls, the privileged helper tool.
</p>
</dd>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSSetDefaultRules" target="_top" -->VSSetDefaultRules<!-- /a --></tt></dt>
<dd><p>Creates default right specifications in the policy database.
</p>
</dd>
</dl>
</div>
<p>&nbsp;</p>
<h3>Utilities</h3>
<div class='group_desc_indent'>
<p> </p></div>
<h4>Group members:</h4>
<div class='group_indent'>
<dl>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSCloseDescriptorArray" target="_top" -->VSCloseDescriptorArray<!-- /a --></tt></dt>
<dd><p>Closes all of the file descriptors referenced by a CFArray.
</p>
</dd>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSErrnoToOSStatus" target="_top" -->VSErrnoToOSStatus<!-- /a --></tt></dt>
<dd><p>Convert an errno value to an OSStatus value.
</p>
</dd>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSGetErrorFromResponse" target="_top" -->VSGetErrorFromResponse<!-- /a --></tt></dt>
<dd><p>Extracts the error status from a helper tool response.
</p>
</dd>
<dt><tt><!-- a logicalPath="//apple_ref/c/func/VSOSStatusToErrno" target="_top" -->VSOSStatusToErrno<!-- /a --></tt></dt>
<dd><p>Convert an OSStatus value to an errno value.
</p>
</dd>
</dl>
</div>
<hr><a name="HeaderDoc_functions"></a>
<h2>Functions</h2>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/func/VSCloseDescriptorArray" target="_top">VSCloseDescriptorArray</a></tt></dt>
<dd><p>Closes all of the file descriptors referenced by a CFArray.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSDiagnoseFailure" target="_top">VSDiagnoseFailure</a></tt></dt>
<dd><p>Determines the cause of a failed request.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSErrnoToOSStatus" target="_top">VSErrnoToOSStatus</a></tt></dt>
<dd><p>Convert an errno value to an OSStatus value.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSExecuteRequestInHelperTool" target="_top">VSExecuteRequestInHelperTool</a></tt></dt>
<dd><p>Executes a request in the privileged helper tool, returning the response.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSFixFailure" target="_top">VSFixFailure</a></tt></dt>
<dd><p>Installs, or reinstalls, the privileged helper tool.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSGetErrorFromResponse" target="_top">VSGetErrorFromResponse</a></tt></dt>
<dd><p>Extracts the error status from a helper tool response.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSHelperToolMain" target="_top">VSHelperToolMain</a></tt></dt>
<dd><p>Entry point for a privileged helper tool.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSOSStatusToErrno" target="_top">VSOSStatusToErrno</a></tt></dt>
<dd><p>Convert an OSStatus value to an errno value.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/func/VSSetDefaultRules" target="_top">VSSetDefaultRules</a></tt></dt>
<dd><p>Creates default right specifications in the policy database.
</p>
</dd>
</dl>
<hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSCloseDescriptorArray;   name=VSCloseDescriptorArray -->
<a name="//apple_ref/c/func/VSCloseDescriptorArray"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSCloseDescriptorArray">VSCloseDescriptorArray</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Closes all of the file descriptors referenced by a CFArray.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void //apple_ref/c/intf/void" --><span class="type">void</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSCloseDescriptorArray //apple_ref/c/clm/VSCloseDescriptorArray //apple_ref/c/intfcm/VSCloseDescriptorArray //apple_ref/c/intfm/VSCloseDescriptorArray //apple_ref/c/func/VSCloseDescriptorArray //apple_ref/c/ftmplt/VSCloseDescriptorArray //apple_ref/c/defn/VSCloseDescriptorArray //apple_ref/c/macro/VSCloseDescriptorArray" --><span class="function">VSCloseDescriptorArray</span><!-- /a -->( 
    <!-- a logicalPath="//apple_ref/c/cl/CFArrayRef //apple_ref/c/tdef/CFArrayRef //apple_ref/c/tag/CFArrayRef //apple_ref/c/econst/CFArrayRef //apple_ref/c/struct/CFArrayRef //apple_ref/c/clconst/CFArrayRef //apple_ref/c/intf/CFArrayRef" --><span class="type">CFArrayRef</span><!-- /a --> <span class="param">descArray</span> );  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>descArray</code></dt><dd><p>The array containing the descriptors to close.
</p>
<p>This may be NULL, in which case the routine does nothing.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>Given a CFArray of CFNumbers, treat each number as a file descriptor 
and close it.
</p>
<p>The most common reason to use this routine is that you've executed, 
using VSExecuteRequestInHelperTool, a request that returns a response 
with embedded file descriptors, and you want to close those descriptors. 
In that case, you typically call this as:
</p>
<p>VSCloseDescriptorArray( CFDictionaryGetValue(response, CFSTR(kVSDescriptorArrayKey)) );
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSDiagnoseFailure;   name=VSDiagnoseFailure -->
<a name="//apple_ref/c/func/VSDiagnoseFailure"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSDiagnoseFailure">VSDiagnoseFailure</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Determines the cause of a failed request.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/VSFailCode //apple_ref/c/tdef/VSFailCode //apple_ref/c/tag/VSFailCode //apple_ref/c/econst/VSFailCode //apple_ref/c/struct/VSFailCode //apple_ref/c/clconst/VSFailCode //apple_ref/c/intf/VSFailCode" --><span class="type">VSFailCode</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSDiagnoseFailure //apple_ref/c/clm/VSDiagnoseFailure //apple_ref/c/intfcm/VSDiagnoseFailure //apple_ref/c/intfm/VSDiagnoseFailure //apple_ref/c/func/VSDiagnoseFailure //apple_ref/c/ftmplt/VSDiagnoseFailure //apple_ref/c/defn/VSDiagnoseFailure //apple_ref/c/macro/VSDiagnoseFailure" --><span class="function">VSDiagnoseFailure</span><!-- /a -->( 
    <!-- a logicalPath="//apple_ref/c/cl/AuthorizationRef //apple_ref/c/tdef/AuthorizationRef //apple_ref/c/tag/AuthorizationRef //apple_ref/c/econst/AuthorizationRef //apple_ref/c/struct/AuthorizationRef //apple_ref/c/clconst/AuthorizationRef //apple_ref/c/intf/AuthorizationRef" --><span class="type">AuthorizationRef</span><!-- /a --> <span class="param">auth</span>, 
    <!-- a logicalPath="//apple_ref/c/cl/CFStringRef //apple_ref/c/tdef/CFStringRef //apple_ref/c/tag/CFStringRef //apple_ref/c/econst/CFStringRef //apple_ref/c/struct/CFStringRef //apple_ref/c/clconst/CFStringRef //apple_ref/c/intf/CFStringRef" --><span class="type">CFStringRef</span><!-- /a --> <span class="param">bundleID</span> );  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>auth</code></dt><dd><p>A reference to your program's authorization instance; you typically get this 
by calling AuthorizationCreate.
</p>
<p>This must not be NULL.</dd>
<dt><code>bundleID</code></dt><dd><p>The bundle identifier for your program.
</p>
<p>This must not be NULL.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5><p><!-- begin return value -->A VSFailCode value indicating the cause of the failure.  This will never be 
kVSFailNeedsUpdate.

<!-- end return value --></p><h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>If VSExecuteRequestInHelperTool fails with an error (indicating an 
IPC failure), you can call this routine to determine what went wrong.  
It returns a VSFailCode value indicating the cause of the failure.  
You should use this value to tell the user what's going on and what 
you intend to do about it.  Once you get the user's consent, you can 
call VSFixFailure to fix the problem.
</p>
<p>For example, if this function result is kVSFailDisabled, you could put up the 
dialog saying:
</p>
<p>My privileged helper tool is disabled.  Would you like to enable it?
This operation may require you to authorize as an admin user.
[Cancel] [[Enable]]
</p>
<p>On the other hand, if this function result is kVSFailNotInstalled, the dialog might be:
</p>
<p>My privileged helper tool is not installed.  Would you like to install it?
This operation may require you to authorize as an admin user.
[Cancel] [[Install]]
</p>
<p>VSDiagnoseFailure will never return kVSFailNeedsUpdate.  It's your responsibility 
to detect version conflicts (a good way to do this is by sending a "get version" request 
to the helper tool).  However, once you've detected a version conflict, you can pass 
kVSFailNeedsUpdate to VSFixFailure to get it to install the latest version of your 
helper tool.
</p>
<p>If you call this routine when everything is working properly, you're likely to get 
a result of kVSFailUnknown.
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSErrnoToOSStatus;   name=VSErrnoToOSStatus -->
<a name="//apple_ref/c/func/VSErrnoToOSStatus"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSErrnoToOSStatus">VSErrnoToOSStatus</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Convert an errno value to an OSStatus value.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/OSStatus //apple_ref/c/tdef/OSStatus //apple_ref/c/tag/OSStatus //apple_ref/c/econst/OSStatus //apple_ref/c/struct/OSStatus //apple_ref/c/clconst/OSStatus //apple_ref/c/intf/OSStatus" --><span class="type">OSStatus</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSErrnoToOSStatus //apple_ref/c/clm/VSErrnoToOSStatus //apple_ref/c/intfcm/VSErrnoToOSStatus //apple_ref/c/intfm/VSErrnoToOSStatus //apple_ref/c/func/VSErrnoToOSStatus //apple_ref/c/ftmplt/VSErrnoToOSStatus //apple_ref/c/defn/VSErrnoToOSStatus //apple_ref/c/macro/VSErrnoToOSStatus" --><span class="function">VSErrnoToOSStatus</span><!-- /a -->(
    <!-- a logicalPath="//apple_ref/c/cl/int //apple_ref/c/tdef/int //apple_ref/c/tag/int //apple_ref/c/econst/int //apple_ref/c/struct/int //apple_ref/c/clconst/int //apple_ref/c/intf/int" --><span class="type">int</span><!-- /a --> <span class="param">errNum</span>);  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>errNum</code></dt><dd><p>The errno value to convert.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5><p><!-- begin return value -->An OSStatus code representing the errno equivalent.

<!-- end return value --></p><h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>All errno values have accepted alternatives in the errSecErrnoBase 
OSStatus range, and this routine does the conversion. For example, 
ENOENT becomes errSecErrnoBase + ENOENT. Any value that's not 
recognised just gets passed through unmodified.
</p>
<p>A value of 0 becomes noErr.
</p>
<p>For more information about errSecErrnoBase, see DTS Q&A 1499 
<http://developer.apple.com/qa/qa2006/qa1499.html>.
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSExecuteRequestInHelperTool;   name=VSExecuteRequestInHelperTool -->
<a name="//apple_ref/c/func/VSExecuteRequestInHelperTool"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSExecuteRequestInHelperTool">VSExecuteRequestInHelperTool</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Executes a request in the privileged helper tool, returning the response.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/OSStatus //apple_ref/c/tdef/OSStatus //apple_ref/c/tag/OSStatus //apple_ref/c/econst/OSStatus //apple_ref/c/struct/OSStatus //apple_ref/c/clconst/OSStatus //apple_ref/c/intf/OSStatus" --><span class="type">OSStatus</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSExecuteRequestInHelperTool //apple_ref/c/clm/VSExecuteRequestInHelperTool //apple_ref/c/intfcm/VSExecuteRequestInHelperTool //apple_ref/c/intfm/VSExecuteRequestInHelperTool //apple_ref/c/func/VSExecuteRequestInHelperTool //apple_ref/c/ftmplt/VSExecuteRequestInHelperTool //apple_ref/c/defn/VSExecuteRequestInHelperTool //apple_ref/c/macro/VSExecuteRequestInHelperTool" --><span class="function">VSExecuteRequestInHelperTool</span><!-- /a -->( 
    <!-- a logicalPath="//apple_ref/c/cl/AuthorizationRef //apple_ref/c/tdef/AuthorizationRef //apple_ref/c/tag/AuthorizationRef //apple_ref/c/econst/AuthorizationRef //apple_ref/c/struct/AuthorizationRef //apple_ref/c/clconst/AuthorizationRef //apple_ref/c/intf/AuthorizationRef" --><span class="type">AuthorizationRef</span><!-- /a --> <span class="param">auth</span>, 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/VSCommandSpec //apple_ref/c/data/VSCommandSpec" --><span class="var">VSCommandSpec</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/commands //apple_ref/c/data/commands" --><span class="var">commands</span><!-- /a -->[], 
    <!-- a logicalPath="//apple_ref/c/econst/CFStringRef //apple_ref/c/data/CFStringRef" --><span class="var">CFStringRef</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/bundleID //apple_ref/c/data/bundleID" --><span class="var">bundleID</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/CFDictionaryRef //apple_ref/c/data/CFDictionaryRef" --><span class="var">CFDictionaryRef</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/request //apple_ref/c/data/request" --><span class="var">request</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/CFDictionaryRef //apple_ref/c/data/CFDictionaryRef" --><span class="var">CFDictionaryRef</span><!-- /a --> <span class="var">*</span> <!-- a logicalPath="//apple_ref/c/econst/response //apple_ref/c/data/response" --><span class="var">response</span><!-- /a --> );  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>auth</code></dt><dd><p>A reference to your program's authorization instance; you typically get this 
by calling AuthorizationCreate.
</p>
<p>This must not be NULL.</dd>
<dt><code>commands</code></dt><dd><p>An array that describes the commands that you implement, and their associated 
rights.  There must be at least one valid command.</dd>
<dt><code>bundleID</code></dt><dd><p>The bundle identifier for your program.
</p>
<p>This must not be NULL.</dd>
<dt><code>request</code></dt><dd><p>A dictionary describing the requested operation.  This must, at least, contain 
a string value for the kVSCommandKey.  Furthermore, this string must match 
one of the commands in the array.
</p>
<p>The dictionary may also contain other values.  These are passed to the helper 
tool unintepreted.  All values must be serialisable using the CFPropertyList 
API.
</p>
<p>This must not be NULL.</dd>
<dt><code>response</code></dt><dd><p>This must not be NULL.  On entry, *response must be NULL.  On success, *response 
will not be NULL.  On error, *response will be NULL.
</p>
<p>On success, you are responsible for disposing of *response.  You are also 
responsible for closing any descriptors returned in the response.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5><p><!-- begin return value -->An OSStatus code (see VSErrnoToOSStatus and VSOSStatusToErrno).

<!-- end return value --></p><h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>This routine synchronously executes a request in the privileged helper tool and 
returns the response.
</p>
<p>If the function returns an error, the IPC between your application and the helper tool 
failed.  Unfortunately it's not possible to tell whether this failure occurred while 
sending the request or receiving the response, thus it's not possible to know whether 
the privileged operation was done or not. 
</p>
<p>If the functions returns no error, the IPC between your application and the helper tool 
was successful.  However, the command may still have failed.  You must get the error 
value from the response (typically using VSGetErrorFromResponse) to see if the 
command succeeded or not.
</p>
<p>On success the response dictionary may contain a value for the kVSDescriptorArrayKey key.  
If so, that will be a non-empty CFArray of CFNumbers, each of which can be accessed as an int.  
Each value is a descriptor that is being returned to you from the helper tool.  You are 
responsible for closing these descriptors when you're done with them. 
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSFixFailure;   name=VSFixFailure -->
<a name="//apple_ref/c/func/VSFixFailure"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSFixFailure">VSFixFailure</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Installs, or reinstalls, the privileged helper tool.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/OSStatus //apple_ref/c/tdef/OSStatus //apple_ref/c/tag/OSStatus //apple_ref/c/econst/OSStatus //apple_ref/c/struct/OSStatus //apple_ref/c/clconst/OSStatus //apple_ref/c/intf/OSStatus" --><span class="type">OSStatus</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSFixFailure //apple_ref/c/clm/VSFixFailure //apple_ref/c/intfcm/VSFixFailure //apple_ref/c/intfm/VSFixFailure //apple_ref/c/func/VSFixFailure //apple_ref/c/ftmplt/VSFixFailure //apple_ref/c/defn/VSFixFailure //apple_ref/c/macro/VSFixFailure" --><span class="function">VSFixFailure</span><!-- /a -->( 
    <!-- a logicalPath="//apple_ref/c/cl/AuthorizationRef //apple_ref/c/tdef/AuthorizationRef //apple_ref/c/tag/AuthorizationRef //apple_ref/c/econst/AuthorizationRef //apple_ref/c/struct/AuthorizationRef //apple_ref/c/clconst/AuthorizationRef //apple_ref/c/intf/AuthorizationRef" --><span class="type">AuthorizationRef</span><!-- /a --> <span class="param">auth</span>, 
    <!-- a logicalPath="//apple_ref/c/cl/CFStringRef //apple_ref/c/tdef/CFStringRef //apple_ref/c/tag/CFStringRef //apple_ref/c/econst/CFStringRef //apple_ref/c/struct/CFStringRef //apple_ref/c/clconst/CFStringRef //apple_ref/c/intf/CFStringRef" --><span class="type">CFStringRef</span><!-- /a --> <span class="param">bundleID</span>, 
    <!-- a logicalPath="//apple_ref/c/cl/CFStringRef //apple_ref/c/tdef/CFStringRef //apple_ref/c/tag/CFStringRef //apple_ref/c/econst/CFStringRef //apple_ref/c/struct/CFStringRef //apple_ref/c/clconst/CFStringRef //apple_ref/c/intf/CFStringRef" --><span class="type">CFStringRef</span><!-- /a --> <span class="param">installToolName</span>, 
    <!-- a logicalPath="//apple_ref/c/cl/CFStringRef //apple_ref/c/tdef/CFStringRef //apple_ref/c/tag/CFStringRef //apple_ref/c/econst/CFStringRef //apple_ref/c/struct/CFStringRef //apple_ref/c/clconst/CFStringRef //apple_ref/c/intf/CFStringRef" --><span class="type">CFStringRef</span><!-- /a --> <span class="param">helperToolName</span>, 
    <!-- a logicalPath="//apple_ref/c/cl/VSFailCode //apple_ref/c/tdef/VSFailCode //apple_ref/c/tag/VSFailCode //apple_ref/c/econst/VSFailCode //apple_ref/c/struct/VSFailCode //apple_ref/c/clconst/VSFailCode //apple_ref/c/intf/VSFailCode" --><span class="type">VSFailCode</span><!-- /a --> <span class="param">failCode</span> );  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>auth</code></dt><dd><p>A reference to your program's authorization instance; you typically get this 
by calling AuthorizationCreate.
</p>
<p>This must not be NULL.</dd>
<dt><code>bundleID</code></dt><dd><p>The bundle identifier for your program.
</p>
<p>This must not be NULL.</dd>
<dt><code>installToolName</code></dt><dd><p>The name of the install tool within your bundle.  You should place the tool 
in the executable directory within the bundle.  Specifically, the tool must be 
available by passing this name to CFBundleCopyAuxiliaryExecutableURL.
</p>
<p>This must not be NULL.</dd>
<dt><code>helperToolName</code></dt><dd><p>The name of the helper tool within your bundle.  You should place the tool 
in the executable directory within the bundle.  Specifically, the tool must be 
available by passing this name to CFBundleCopyAuxiliaryExecutableURL.
</p>
<p>This must not be NULL.</dd>
<dt><code>failCode</code></dt><dd><p>A value indicating the type of failure that's occurred.  In most cases you get this 
value by calling VSDiagnoseFailure.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5><p><!-- begin return value -->An OSStatus code (see VSErrnoToOSStatus and VSOSStatusToErrno).			

<!-- end return value --></p><h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>This routine installs or reinstalls the privileged helper tool.  Typically 
you call this in response to an IPC failure talking to the tool.  You first 
diagnose the failure using VSDiagnoseFailure and then call this routine to 
fix the failure by installing (or reinstalling) the tool.
</p>
<p>Because the helper tool is privileged, installing it is a privileged 
operation.  This routine will do its work by calling 
AuthorizationExecuteWithPrivileges, which is likely to prompt the user 
for an admin name and password.
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSGetErrorFromResponse;   name=VSGetErrorFromResponse -->
<a name="//apple_ref/c/func/VSGetErrorFromResponse"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSGetErrorFromResponse">VSGetErrorFromResponse</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Extracts the error status from a helper tool response.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/OSStatus //apple_ref/c/tdef/OSStatus //apple_ref/c/tag/OSStatus //apple_ref/c/econst/OSStatus //apple_ref/c/struct/OSStatus //apple_ref/c/clconst/OSStatus //apple_ref/c/intf/OSStatus" --><span class="type">OSStatus</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSGetErrorFromResponse //apple_ref/c/clm/VSGetErrorFromResponse //apple_ref/c/intfcm/VSGetErrorFromResponse //apple_ref/c/intfm/VSGetErrorFromResponse //apple_ref/c/func/VSGetErrorFromResponse //apple_ref/c/ftmplt/VSGetErrorFromResponse //apple_ref/c/defn/VSGetErrorFromResponse //apple_ref/c/macro/VSGetErrorFromResponse" --><span class="function">VSGetErrorFromResponse</span><!-- /a -->(
    <!-- a logicalPath="//apple_ref/c/cl/CFDictionaryRef //apple_ref/c/tdef/CFDictionaryRef //apple_ref/c/tag/CFDictionaryRef //apple_ref/c/econst/CFDictionaryRef //apple_ref/c/struct/CFDictionaryRef //apple_ref/c/clconst/CFDictionaryRef //apple_ref/c/intf/CFDictionaryRef" --><span class="type">CFDictionaryRef</span><!-- /a --> <span class="param">response</span>);  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>response</code></dt><dd><p>A helper tool response, typically acquired by calling VSExecuteRequestInHelperTool.
</p>
<p>This must not be NULL</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5><p><!-- begin return value -->An OSStatus code (see VSErrnoToOSStatus and VSOSStatusToErrno).

<!-- end return value --></p><h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>This function extracts the error status from a helper tool response. 
Specifically, its uses the kVSErrorKey key to get a CFNumber and 
it gets the resulting value from that number.
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSHelperToolMain;   name=VSHelperToolMain -->
<a name="//apple_ref/c/func/VSHelperToolMain"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSHelperToolMain">VSHelperToolMain</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Entry point for a privileged helper tool.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/int //apple_ref/c/tdef/int //apple_ref/c/tag/int //apple_ref/c/econst/int //apple_ref/c/struct/int //apple_ref/c/clconst/int //apple_ref/c/intf/int" --><span class="type">int</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSHelperToolMain //apple_ref/c/clm/VSHelperToolMain //apple_ref/c/intfcm/VSHelperToolMain //apple_ref/c/intfm/VSHelperToolMain //apple_ref/c/func/VSHelperToolMain //apple_ref/c/ftmplt/VSHelperToolMain //apple_ref/c/defn/VSHelperToolMain //apple_ref/c/macro/VSHelperToolMain" --><span class="function">VSHelperToolMain</span><!-- /a -->( 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/VSCommandSpec //apple_ref/c/data/VSCommandSpec" --><span class="var">VSCommandSpec</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/commands //apple_ref/c/data/commands" --><span class="var">commands</span><!-- /a -->[], 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/VSCommandProc //apple_ref/c/data/VSCommandProc" --><span class="var">VSCommandProc</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/commandProcs //apple_ref/c/data/commandProcs" --><span class="var">commandProcs</span><!-- /a -->[] );  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>commands</code></dt><dd><p>An array that describes the commands that you implement, and their associated 
rights.  The array is terminated by a command with a NULL name.  There must be 
at least one valid command.</dd>
<dt><code>commandProcs</code></dt><dd><p>An array of callback routines that are called when a valid request arrives.  The 
array is expected to perform the operation associated with the corresponding 
command and set up the response values, if any.  The array is terminated by a 
NULL pointer.
</p>
<p>IMPORTANT: The array must have exactly the same number of entries as the 
commands array.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5><p><!-- begin return value -->An integer representing EXIT_SUCCESS or EXIT_FAILURE.

<!-- end return value --></p><h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>You should call this function from the main function of your helper tool.  It takes 
care of all of the details of receiving and processing commands.  It will call you 
back (via one of the commandProcs callbacks) when a valid request arrives.
</p>
<p>This function assumes acts like a replacement for main.  Thus, it assumes that 
it owns various process-wide resources (like SIGALRM and the disposition of 
SIGPIPE).  You should not use those resources, either in your main function or 
in your callback function.  Also, you should not call this function on a thread, 
or start any other threads in the process.  Finally, this function has a habit of 
exiting the entire process if something goes wrong.  You should not expect the 
function to always return.
</p>
<p>This function does not clean up after itself.  When this function returns, you 
are expected to exit.  If the function result is noErr, the command processing 
loop quit in an expected manner (typically because of an idle timeout).  Otherwise 
it quit because of an error.
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSOSStatusToErrno;   name=VSOSStatusToErrno -->
<a name="//apple_ref/c/func/VSOSStatusToErrno"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSOSStatusToErrno">VSOSStatusToErrno</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Convert an OSStatus value to an errno value.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/int //apple_ref/c/tdef/int //apple_ref/c/tag/int //apple_ref/c/econst/int //apple_ref/c/struct/int //apple_ref/c/clconst/int //apple_ref/c/intf/int" --><span class="type">int</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSOSStatusToErrno //apple_ref/c/clm/VSOSStatusToErrno //apple_ref/c/intfcm/VSOSStatusToErrno //apple_ref/c/intfm/VSOSStatusToErrno //apple_ref/c/func/VSOSStatusToErrno //apple_ref/c/ftmplt/VSOSStatusToErrno //apple_ref/c/defn/VSOSStatusToErrno //apple_ref/c/macro/VSOSStatusToErrno" --><span class="function">VSOSStatusToErrno</span><!-- /a -->(
    <!-- a logicalPath="//apple_ref/c/cl/OSStatus //apple_ref/c/tdef/OSStatus //apple_ref/c/tag/OSStatus //apple_ref/c/econst/OSStatus //apple_ref/c/struct/OSStatus //apple_ref/c/clconst/OSStatus //apple_ref/c/intf/OSStatus" --><span class="type">OSStatus</span><!-- /a --> <span class="param">errNum</span>);  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>errNum</code></dt><dd><p>The OSStatus value to convert.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Return Value</font></h5><p><!-- begin return value -->An integer code representing the OSStatus equivalent.

<!-- end return value --></p><h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>This function converts some specific OSStatus values (Open Transport and
errSecErrnoBase ranges) to their corresponding errno values.  It more-or-less 
undoes the conversion done by VSErrnoToOSStatus, including a pass 
through for unrecognised values.
</p>
<p>It's worth noting that there are many more defined OSStatus error codes 
than errno error codes, so you're more likely to encounter a passed 
through value when going in this direction.
</p>
<p>A value of noErr becomes 0.
</p>
<p>For more information about errSecErrnoBase, see DTS Q&A 1499 
<http://developer.apple.com/qa/qa2006/qa1499.html>.
</p>
<!-- end discussion -->
<p></p><hr><!-- headerDoc=func;  uid=//apple_ref/c/func/VSSetDefaultRules;   name=VSSetDefaultRules -->
<a name="//apple_ref/c/func/VSSetDefaultRules"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSSetDefaultRules">VSSetDefaultRules</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Creates default right specifications in the policy database.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">extern</span> <!-- a logicalPath="//apple_ref/c/cl/void //apple_ref/c/tdef/void //apple_ref/c/tag/void //apple_ref/c/econst/void //apple_ref/c/struct/void //apple_ref/c/clconst/void //apple_ref/c/intf/void" --><span class="type">void</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/instm/VSSetDefaultRules //apple_ref/c/clm/VSSetDefaultRules //apple_ref/c/intfcm/VSSetDefaultRules //apple_ref/c/intfm/VSSetDefaultRules //apple_ref/c/func/VSSetDefaultRules //apple_ref/c/ftmplt/VSSetDefaultRules //apple_ref/c/defn/VSSetDefaultRules //apple_ref/c/macro/VSSetDefaultRules" --><span class="function">VSSetDefaultRules</span><!-- /a -->( 
    <!-- a logicalPath="//apple_ref/c/cl/AuthorizationRef //apple_ref/c/tdef/AuthorizationRef //apple_ref/c/tag/AuthorizationRef //apple_ref/c/econst/AuthorizationRef //apple_ref/c/struct/AuthorizationRef //apple_ref/c/clconst/AuthorizationRef //apple_ref/c/intf/AuthorizationRef" --><span class="type">AuthorizationRef</span><!-- /a --> <span class="param">auth</span>, 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/VSCommandSpec //apple_ref/c/data/VSCommandSpec" --><span class="var">VSCommandSpec</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/commands //apple_ref/c/data/commands" --><span class="var">commands</span><!-- /a -->[], 
    <!-- a logicalPath="//apple_ref/c/econst/CFStringRef //apple_ref/c/data/CFStringRef" --><span class="var">CFStringRef</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/bundleID //apple_ref/c/data/bundleID" --><span class="var">bundleID</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/CFStringRef //apple_ref/c/data/CFStringRef" --><span class="var">CFStringRef</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/descriptionStringTableName //apple_ref/c/data/descriptionStringTableName" --><span class="var">descriptionStringTableName</span><!-- /a --> );  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Parameters</font></h5>
<div class='param_indent'>
<dl>
<dt><code>auth</code></dt><dd><p>A reference to your program's authorization instance; you typically get this 
by calling AuthorizationCreate.
</p>
<p>This must not be NULL.</dd>
<dt><code>commands</code></dt><dd><p>An array that describes the commands that you implement, and their associated 
rights.  There must be at least one valid command.</dd>
<dt><code>bundleID</code></dt><dd><p>The bundle identifier for your program.
</p>
<p>This must not be NULL.</dd>
<dt><code>descriptionStringTableName</code></dt><dd><p>The name of the .strings file from which to fetch the localised custom 
prompts for the rights in the commands array (if any).  A NULL value is 
equivalent to passing "Localizable" (that is, it gets the prompts from 
"Localizable.strings").
</p>
<p>For example, imagine you have a command for which you require a custom prompt.  
You should put the custom prompt in a .strings file, let's call it 
"AuthPrompts.strings".  You should then pass "AuthPrompts" to this parameter 
and put the key that gets the prompt into the rightDescriptionKey of the command.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>This routine ensures that the policy database (currently 
"/etc/authorization") contains right specifications for all of the rights 
that you use (as specified by the commands array).  This has two important 
consequences:
</p>
<p>1. It makes the rights that you use visible to the system administrator.  
All they have to do is run your program once and they can see your default 
right specifications in the policy database. 
</p>
<p>2. It means that, when the privileged helper tool tries to acquire the right, 
it will use your specification of the right (as modified by the system 
administrator) rather than the default right specification. 
</p>
<p>You must call this function before calling VSExecuteRequestInHelperTool.  
Typically you would call it at application startup time, or lazily, immediately 
before calling VSExecuteRequestInHelperTool.
</p>
<!-- end discussion -->
<p></p><a name="HeaderDoc_datatypes"></a>
<h2>Typedefs</h2>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/tdef/VSCommandProc" target="_top">VSCommandProc</a></tt></dt>
<dd><p>Command processing callback.
</p>
</dd>
</dl>
<hr><!-- headerDoc=tdef;  uid=//apple_ref/c/tdef/VSCommandProc;   name=VSCommandProc -->
<a name="//apple_ref/c/tdef/VSCommandProc"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSCommandProc">VSCommandProc</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Command processing callback.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">typedef</span> <!-- a logicalPath="//apple_ref/c/cl/OSStatus //apple_ref/c/tdef/OSStatus //apple_ref/c/tag/OSStatus //apple_ref/c/econst/OSStatus //apple_ref/c/struct/OSStatus //apple_ref/c/clconst/OSStatus //apple_ref/c/intf/OSStatus" --><span class="type">OSStatus</span><!-- /a --> ( <span class="type">*</span><!-- a logicalPath="//apple_ref/c/instm/VSCommandProc //apple_ref/c/clm/VSCommandProc //apple_ref/c/intfcm/VSCommandProc //apple_ref/c/intfm/VSCommandProc //apple_ref/c/func/VSCommandProc //apple_ref/c/ftmplt/VSCommandProc //apple_ref/c/defn/VSCommandProc //apple_ref/c/macro/VSCommandProc" --><span class="function">VSCommandProc</span><!-- /a -->)( 
    <!-- a logicalPath="//apple_ref/c/cl/AuthorizationRef //apple_ref/c/tdef/AuthorizationRef //apple_ref/c/tag/AuthorizationRef //apple_ref/c/econst/AuthorizationRef //apple_ref/c/struct/AuthorizationRef //apple_ref/c/clconst/AuthorizationRef //apple_ref/c/intf/AuthorizationRef" --><span class="type">AuthorizationRef</span><!-- /a --> <span class="param">auth</span>, 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/void //apple_ref/c/data/void" --><span class="var">void</span><!-- /a --> <span class="var">*</span> <!-- a logicalPath="//apple_ref/c/econst/userData //apple_ref/c/data/userData" --><span class="var">userData</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/CFDictionaryRef //apple_ref/c/data/CFDictionaryRef" --><span class="var">CFDictionaryRef</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/request //apple_ref/c/data/request" --><span class="var">request</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/CFMutableDictionaryRef //apple_ref/c/data/CFMutableDictionaryRef" --><span class="var">CFMutableDictionaryRef</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/response //apple_ref/c/data/response" --><span class="var">response</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/aslclient //apple_ref/c/data/aslclient" --><span class="var">aslclient</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/asl //apple_ref/c/data/asl" --><span class="var">asl</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/aslmsg //apple_ref/c/data/aslmsg" --><span class="var">aslmsg</span><!-- /a --> <!-- a logicalPath="//apple_ref/c/econst/aslMsg //apple_ref/c/data/aslMsg" --><span class="var">aslMsg</span><!-- /a --> );  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<div class='param_indent'>
<dl>
<dt><code>auth</code></dt><dd><p>This is a reference to the authorization instance associated with the original 
application that made the request.
</p>
<p>This will never be NULL.</dd>
<dt><code>userData</code></dt><dd><p>This is the value from the userData field of the corresponding entry in the 
VSCommandSpec array that you passed to VSHelperToolMain.</dd>
<dt><code>request</code></dt><dd><p>This dictionary contains the request.  It will have, at a bare minimum, a 
kVSCommandKey item whose value matches one of the commands in the 
VSCommandSpec array you passed to VSHelperToolMain.  It may also have 
other, command-specific parameters.
</p>
<p>This will never be NULL.</dd>
<dt><code>response</code></dt><dd><p>This is a dictionary into which you can place the response.  It will start out 
empty, and you can add any results you please to it.
</p>
<p>If you need to return file descriptors, place them in an array and place that 
array in the response using the kVSDescriptorArrayKey key.
</p>
<p>There's no need to set the error result in the response.  VSHelperToolMain will 
do that for you.  However, if you do set a value for the kVSErrorKey key, 
that value will take precedence; in this case, the function result is ignored.
</p>
<p>This will never be NULL.</dd>
<dt><code>asl</code></dt><dd><p>A reference to the ASL client handle for logging.
</p>
<p>This may be NULL.  However, ASL handles a NULL input, so you don't need to 
conditionalise your code.</dd>
<dt><code>aslMsg</code></dt><dd><p>A reference to a ASL message template for logging.
</p>
<p>This may be NULL.  However, ASL handles a NULL input, so you don't need to 
conditionalise your code.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>When your helper tool calls VSHelperToolMain, it passes in a pointer to an 
array of callback functions of this type.  When VSHelperToolMain receives a 
valid command, it calls one of these function so that your program-specific 
code can process the request.  VSAuthorization guarantees that the effective, save and 
real user IDs (EUID, SUID, RUID) will all be zero at this point (that is, 
you're "running as root").
</p>
<p>By the time this callback is called, VSHelperToolMain has already verified that 
this is a known command.  It also acquires the authorization right associated 
with the command, if any.  However, it does nothing to validate the other 
parameters in the request.  These parameters come from a non-privileged source 
and you should verify them carefully.
</p>
<p>Your implementation should get any input parameters from the request and place 
any output parameters in the response.  It can also put an array of file 
descriptors into the response using the kVSDescriptorArrayKey key.
</p>
<p>If an error occurs, you should just return an appropriate error code.  
VSHelperToolMain will ensure that this gets placed in the response.
</p>
<p>You should attempt to fail before adding any file descriptors to the response, 
or remove them once you know that you're going to fail.  If you put file 
descriptors into the response and then return an error, those descriptors will 
still be passed back to the client.  It's likely the client isn't expecting this.
</p>
<p>Calls to this function will be serialised; that is, once your callback is 
running, VSHelperToolMain won't call you again until you return.  Your callback 
should avoid blocking for long periods of time.  If you block for too long, the 
VSAuthorization watchdog will kill the entire helper tool process.
</p>
<p>This callback runs in a daemon context; you must avoid doing things that require the 
user's context.  For example, launching a GUI application would be bad.  See 
Technote 2083 "Daemons and Agents" for more information about execution contexts.
</p>
<!-- end discussion -->
<p></p><a name="HeaderDoc_structs"></a>
<h2>Structs and Unions</h2>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/tag/VSCommandSpec" target="_top">VSCommandSpec</a></tt></dt>
<dd><p>Describes a privileged operation to VSAuthorizationHelperToolLib.
</p>
</dd>
</dl>
<hr><!-- headerDoc=tag;  uid=//apple_ref/c/tag/VSCommandSpec;   name=VSCommandSpec -->
<a name="//apple_ref/c/tag/VSCommandSpec"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSCommandSpec">VSCommandSpec</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Describes a privileged operation to VSAuthorizationHelperToolLib.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">struct</span> <!-- a logicalPath="//apple_ref/c/cl/VSCommandSpec //apple_ref/c/tdef/VSCommandSpec //apple_ref/c/tag/VSCommandSpec //apple_ref/c/econst/VSCommandSpec //apple_ref/c/struct/VSCommandSpec //apple_ref/c/clconst/VSCommandSpec //apple_ref/c/intf/VSCommandSpec" --><span class="type">VSCommandSpec</span><!-- /a --> { 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/char //apple_ref/c/data/char" --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a logicalPath="//apple_ref/c/econst/commandName //apple_ref/c/data/commandName" --><span class="var">commandName</span><!-- /a -->; 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/char //apple_ref/c/data/char" --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a logicalPath="//apple_ref/c/econst/rightName //apple_ref/c/data/rightName" --><span class="var">rightName</span><!-- /a -->; 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/char //apple_ref/c/data/char" --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a logicalPath="//apple_ref/c/econst/rightDefaultRule //apple_ref/c/data/rightDefaultRule" --><span class="var">rightDefaultRule</span><!-- /a -->; 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/char //apple_ref/c/data/char" --><span class="var">char</span><!-- /a --> <span class="var">*</span><!-- a logicalPath="//apple_ref/c/econst/rightDescriptionKey //apple_ref/c/data/rightDescriptionKey" --><span class="var">rightDescriptionKey</span><!-- /a -->; 
    <span class="keyword">const</span> <!-- a logicalPath="//apple_ref/c/econst/void //apple_ref/c/data/void" --><span class="var">void</span><!-- /a --> <span class="var">*</span><!-- a logicalPath="//apple_ref/c/econst/userData //apple_ref/c/data/userData" --><span class="var">userData</span><!-- /a -->; 
};  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Fields</font></h5>
<div class='param_indent'>
<dl>
<dt><code>commandName</code></dt><dd><p>A identifier for this command.  This can be any string that is unique within 
the context of your programs.  A NULL value in this field terminates the array.
</p>
<p>The length of the command name must not be greater than 1024 UTF-16 values.</dd>
<dt><code>rightName</code></dt><dd><p>This is the name of the authorization right associated with the 
command.  This can be NULL if you don't want any right associated with the 
command.  If it's not NULL, VSAuthorizationHelperToolLib will acquire that right 
before allowing the command to execute.</dd>
<dt><code>rightDefaultRule</code></dt><dd><p>This is the name of an authorization rule that should be used in 
the default right specification for the right.  To see a full list of these rules, 
look at the "rules" dictionary within the policy database (currently 
"/etc/authorization").  Common values include "default" (which requires that the user 
hold credentials that authenticate them as an admin user) and "allow" (which will let 
anyone acquire the right).
</p>
<p>This must be NULL if (and only if) rightName is NULL.</dd>
<dt><code>rightDescriptionKey</code></dt><dd><p>This is a key used to form a custom prompt for the right.  The value of this 
string should be a key into a .strings file whose name you supply to 
VSSetDefaultRules.  When VSAuthorizationHelperToolLib creates the right specification, 
it uses this key to get all of the localised prompt strings for the right.
</p>
<p>This must be NULL if rightName is NULL.  Otherwise, this may be NULL if you 
don't want a custom prompt for your right.</dd>
<dt><code>userData</code></dt><dd><p>This field is is for the benefit of the client; VSAuthorizationHelperToolLib 
does not use it in any way.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>Both the application and the tool must tell VSAuthorizationHelperToolLib about 
the operations (that is, commands) that they support.  They do this by passing 
in an array of VSCommandSpec structures.  Each element describes one command.  
The array is terminated by a command whose commandName field is NULL.
</p>
<p>In general the application and tool should use the same array definition.  
However, there are cases where these might be out of sync.  For example, if you 
have an older version of the application talking to a newer version of the tool, 
the tool might know about more commands than the application (and thus provide a 
longer array), and that's OK.
</p>
<!-- end discussion -->
<p></p><a name="HeaderDoc_enums"></a>
<h2>Enumerated Types</h2>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/tag/VSFailCode" target="_top">VSFailCode</a></tt></dt>
<dd><p>Indicates why a request failed.
</p>
</dd>
</dl>
<hr><!-- headerDoc=tag;  uid=//apple_ref/c/tag/VSFailCode;   name=VSFailCode -->
<a name="//apple_ref/c/tag/VSFailCode"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="VSFailCode">VSFailCode</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Indicates why a request failed.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="keyword">enum</span> { 
    <!-- a logicalPath="//apple_ref/c/econst/kVSFailUnknown //apple_ref/c/data/kVSFailUnknown" --><span class="var">kVSFailUnknown</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/kVSFailDisabled //apple_ref/c/data/kVSFailDisabled" --><span class="var">kVSFailDisabled</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/kVSFailPartiallyInstalled //apple_ref/c/data/kVSFailPartiallyInstalled" --><span class="var">kVSFailPartiallyInstalled</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/kVSFailNotInstalled //apple_ref/c/data/kVSFailNotInstalled" --><span class="var">kVSFailNotInstalled</span><!-- /a -->, 
    <!-- a logicalPath="//apple_ref/c/econst/kVSFailNeedsUpdate //apple_ref/c/data/kVSFailNeedsUpdate" --><span class="var">kVSFailNeedsUpdate</span><!-- /a --> 
};  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Constants</font></h5>
<div class='param_indent'>
<dl>
<dt><a name="//apple_ref/c/econst/VSFailCode/kVSFailUnknown"><code>kVSFailUnknown</code></a></dt><dd><p>Indicates that VSDiagnoseFailure could not accurately determine the cause of the 
failure.</dd>
<dt><a name="//apple_ref/c/econst/VSFailCode/kVSFailDisabled"><code>kVSFailDisabled</code></a></dt><dd><p>The request failed because the helper tool is installed but disabled.</dd>
<dt><a name="//apple_ref/c/econst/VSFailCode/kVSFailPartiallyInstalled"><code>kVSFailPartiallyInstalled</code></a></dt><dd><p>The request failed because the helper tool is only partially installed.</dd>
<dt><a name="//apple_ref/c/econst/VSFailCode/kVSFailNotInstalled"><code>kVSFailNotInstalled</code></a></dt><dd><p>The request failed because the helper tool is not installed at all.</dd>
<dt><a name="//apple_ref/c/econst/VSFailCode/kVSFailNeedsUpdate"><code>kVSFailNeedsUpdate</code></a></dt><dd><p>The request failed because the helper tool is installed but out of date. 
VSDiagnoseFailure will never return this value.  However, if you detect that 
the helper tool is out of date (typically by sending it a "get version" request) 
you can pass this value to VSFixFailure to force it to update the tool.</dd>
</dl>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>If VSExecuteRequestInHelperTool fails with an error (indicating 
an IPC failure), you can call VSDiagnoseFailure to determine what 
went wrong.  VSDiagnoseFailure will return the value of this 
type that best describes the failure.
</p>
<!-- end discussion -->
<p></p><a name="HeaderDoc_pdefines"></a>
<h2>Macro Definitions</h2>
<dl>
<dt><tt><a href="index.html#//apple_ref/c/macro/kVSCommandKey" target="_top">kVSCommandKey</a></tt></dt>
<dd><p>Key for the command string within the request dictionary.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/macro/kVSDescriptorArrayKey" target="_top">kVSDescriptorArrayKey</a></tt></dt>
<dd><p>Key for a file descriptor array within the response dictionary.
</p>
</dd>
<dt><tt><a href="index.html#//apple_ref/c/macro/kVSErrorKey" target="_top">kVSErrorKey</a></tt></dt>
<dd><p>Key for the error result within the response dictionary.
</p>
</dd>
</dl>
<hr><!-- headerDoc=macro;  uid=//apple_ref/c/macro/kVSCommandKey;   name=kVSCommandKey -->
<a name="//apple_ref/c/macro/kVSCommandKey"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="kVSCommandKey">kVSCommandKey</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Key for the command string within the request dictionary.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="">#define</span><span class="preprocessor"> </span><!-- a logicalPath="//apple_ref/c/cl/kVSCommandKey //apple_ref/c/tdef/kVSCommandKey //apple_ref/c/tag/kVSCommandKey //apple_ref/c/econst/kVSCommandKey //apple_ref/c/struct/kVSCommandKey //apple_ref/c/data/kVSCommandKey //apple_ref/c/clconst/kVSCommandKey //apple_ref/c/intf/kVSCommandKey //apple_ref/c/instm/kVSCommandKey //apple_ref/c/clm/kVSCommandKey //apple_ref/c/intfcm/kVSCommandKey //apple_ref/c/intfm/kVSCommandKey //apple_ref/c/func/kVSCommandKey //apple_ref/c/ftmplt/kVSCommandKey //apple_ref/c/defn/kVSCommandKey //apple_ref/c/macro/kVSCommandKey //apple_ref/doc/com/intfm/kVSCommandKey" --><span class="preprocessor">kVSCommandKey</span><!-- /a --><span class="preprocessor"> </span><span class="preprocessor">"</span><!-- a logicalPath="//apple_ref/c/cl/com //apple_ref/c/tdef/com //apple_ref/c/tag/com //apple_ref/c/econst/com //apple_ref/c/struct/com //apple_ref/c/data/com //apple_ref/c/clconst/com //apple_ref/c/intf/com //apple_ref/c/instm/com //apple_ref/c/clm/com //apple_ref/c/intfcm/com //apple_ref/c/intfm/com //apple_ref/c/func/com //apple_ref/c/ftmplt/com //apple_ref/c/defn/com //apple_ref/c/macro/com //apple_ref/doc/com/intfm/com" --><span class="preprocessor">com</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/markdouma //apple_ref/c/tdef/markdouma //apple_ref/c/tag/markdouma //apple_ref/c/econst/markdouma //apple_ref/c/struct/markdouma //apple_ref/c/data/markdouma //apple_ref/c/clconst/markdouma //apple_ref/c/intf/markdouma //apple_ref/c/instm/markdouma //apple_ref/c/clm/markdouma //apple_ref/c/intfcm/markdouma //apple_ref/c/intfm/markdouma //apple_ref/c/func/markdouma //apple_ref/c/ftmplt/markdouma //apple_ref/c/defn/markdouma //apple_ref/c/macro/markdouma //apple_ref/doc/com/intfm/markdouma" --><span class="preprocessor">markdouma</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/SourceFinagler //apple_ref/c/tdef/SourceFinagler //apple_ref/c/tag/SourceFinagler //apple_ref/c/econst/SourceFinagler //apple_ref/c/struct/SourceFinagler //apple_ref/c/data/SourceFinagler //apple_ref/c/clconst/SourceFinagler //apple_ref/c/intf/SourceFinagler //apple_ref/c/instm/SourceFinagler //apple_ref/c/clm/SourceFinagler //apple_ref/c/intfcm/SourceFinagler //apple_ref/c/intfm/SourceFinagler //apple_ref/c/func/SourceFinagler //apple_ref/c/ftmplt/SourceFinagler //apple_ref/c/defn/SourceFinagler //apple_ref/c/macro/SourceFinagler //apple_ref/doc/com/intfm/SourceFinagler" --><span class="preprocessor">SourceFinagler</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/command //apple_ref/c/tdef/command //apple_ref/c/tag/command //apple_ref/c/econst/command //apple_ref/c/struct/command //apple_ref/c/data/command //apple_ref/c/clconst/command //apple_ref/c/intf/command //apple_ref/c/instm/command //apple_ref/c/clm/command //apple_ref/c/intfcm/command //apple_ref/c/intfm/command //apple_ref/c/func/command //apple_ref/c/ftmplt/command //apple_ref/c/defn/command //apple_ref/c/macro/command //apple_ref/doc/com/intfm/command" --><span class="preprocessor">command</span><!-- /a --><span class="preprocessor">"</span><span class="preprocessor"> </span><span class="comment"><span class="comment">//</span><span class="comment"></span><span class="comment"> </span><span class="comment">CFString</span></span>  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>Within a request, this key must reference a string that is the name of the 
command to execute.  This must match one of the commands in the 
VSCommandSpec array.
</p>
<p>The length of a command name must not be greater than 1024 UTF-16 values.
<!-- end discussion -->
<p></p><hr><!-- headerDoc=macro;  uid=//apple_ref/c/macro/kVSDescriptorArrayKey;   name=kVSDescriptorArrayKey -->
<a name="//apple_ref/c/macro/kVSDescriptorArrayKey"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="kVSDescriptorArrayKey">kVSDescriptorArrayKey</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Key for a file descriptor array within the response dictionary.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="">#define</span><span class="preprocessor"> </span><!-- a logicalPath="//apple_ref/c/cl/kVSDescriptorArrayKey //apple_ref/c/tdef/kVSDescriptorArrayKey //apple_ref/c/tag/kVSDescriptorArrayKey //apple_ref/c/econst/kVSDescriptorArrayKey //apple_ref/c/struct/kVSDescriptorArrayKey //apple_ref/c/data/kVSDescriptorArrayKey //apple_ref/c/clconst/kVSDescriptorArrayKey //apple_ref/c/intf/kVSDescriptorArrayKey //apple_ref/c/instm/kVSDescriptorArrayKey //apple_ref/c/clm/kVSDescriptorArrayKey //apple_ref/c/intfcm/kVSDescriptorArrayKey //apple_ref/c/intfm/kVSDescriptorArrayKey //apple_ref/c/func/kVSDescriptorArrayKey //apple_ref/c/ftmplt/kVSDescriptorArrayKey //apple_ref/c/defn/kVSDescriptorArrayKey //apple_ref/c/macro/kVSDescriptorArrayKey //apple_ref/doc/com/intfm/kVSDescriptorArrayKey" --><span class="preprocessor">kVSDescriptorArrayKey</span><!-- /a --><span class="preprocessor"> </span><span class="preprocessor">"</span><!-- a logicalPath="//apple_ref/c/cl/com //apple_ref/c/tdef/com //apple_ref/c/tag/com //apple_ref/c/econst/com //apple_ref/c/struct/com //apple_ref/c/data/com //apple_ref/c/clconst/com //apple_ref/c/intf/com //apple_ref/c/instm/com //apple_ref/c/clm/com //apple_ref/c/intfcm/com //apple_ref/c/intfm/com //apple_ref/c/func/com //apple_ref/c/ftmplt/com //apple_ref/c/defn/com //apple_ref/c/macro/com //apple_ref/doc/com/intfm/com" --><span class="preprocessor">com</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/markdouma //apple_ref/c/tdef/markdouma //apple_ref/c/tag/markdouma //apple_ref/c/econst/markdouma //apple_ref/c/struct/markdouma //apple_ref/c/data/markdouma //apple_ref/c/clconst/markdouma //apple_ref/c/intf/markdouma //apple_ref/c/instm/markdouma //apple_ref/c/clm/markdouma //apple_ref/c/intfcm/markdouma //apple_ref/c/intfm/markdouma //apple_ref/c/func/markdouma //apple_ref/c/ftmplt/markdouma //apple_ref/c/defn/markdouma //apple_ref/c/macro/markdouma //apple_ref/doc/com/intfm/markdouma" --><span class="preprocessor">markdouma</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/SourceFinagler //apple_ref/c/tdef/SourceFinagler //apple_ref/c/tag/SourceFinagler //apple_ref/c/econst/SourceFinagler //apple_ref/c/struct/SourceFinagler //apple_ref/c/data/SourceFinagler //apple_ref/c/clconst/SourceFinagler //apple_ref/c/intf/SourceFinagler //apple_ref/c/instm/SourceFinagler //apple_ref/c/clm/SourceFinagler //apple_ref/c/intfcm/SourceFinagler //apple_ref/c/intfm/SourceFinagler //apple_ref/c/func/SourceFinagler //apple_ref/c/ftmplt/SourceFinagler //apple_ref/c/defn/SourceFinagler //apple_ref/c/macro/SourceFinagler //apple_ref/doc/com/intfm/SourceFinagler" --><span class="preprocessor">SourceFinagler</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/descriptors //apple_ref/c/tdef/descriptors //apple_ref/c/tag/descriptors //apple_ref/c/econst/descriptors //apple_ref/c/struct/descriptors //apple_ref/c/data/descriptors //apple_ref/c/clconst/descriptors //apple_ref/c/intf/descriptors //apple_ref/c/instm/descriptors //apple_ref/c/clm/descriptors //apple_ref/c/intfcm/descriptors //apple_ref/c/intfm/descriptors //apple_ref/c/func/descriptors //apple_ref/c/ftmplt/descriptors //apple_ref/c/defn/descriptors //apple_ref/c/macro/descriptors //apple_ref/doc/com/intfm/descriptors" --><span class="preprocessor">descriptors</span><!-- /a --><span class="preprocessor">"</span><span class="preprocessor"> </span><span class="comment"><span class="comment">//</span><span class="comment"></span><span class="comment"> </span><span class="comment">CFArray of CFNumber</span></span>  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>Within a response, this key, if present, must reference an array 
of numbers, which are the file descriptors being returned with 
the response.  The numbers are interpreted as ints.
<!-- end discussion -->
<p></p><hr><!-- headerDoc=macro;  uid=//apple_ref/c/macro/kVSErrorKey;   name=kVSErrorKey -->
<a name="//apple_ref/c/macro/kVSErrorKey"></a>
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5"><h3><a name="kVSErrorKey">kVSErrorKey</a></h3>
</td></tr></table><hr><p><!-- begin abstract --><p>Key for the error result within the response dictionary.
</p>
<!-- end abstract --></p>
<p></p><div class='declaration_indent'>
<pre><span class="">#define</span><span class="preprocessor"> </span><!-- a logicalPath="//apple_ref/c/cl/kVSErrorKey //apple_ref/c/tdef/kVSErrorKey //apple_ref/c/tag/kVSErrorKey //apple_ref/c/econst/kVSErrorKey //apple_ref/c/struct/kVSErrorKey //apple_ref/c/data/kVSErrorKey //apple_ref/c/clconst/kVSErrorKey //apple_ref/c/intf/kVSErrorKey //apple_ref/c/instm/kVSErrorKey //apple_ref/c/clm/kVSErrorKey //apple_ref/c/intfcm/kVSErrorKey //apple_ref/c/intfm/kVSErrorKey //apple_ref/c/func/kVSErrorKey //apple_ref/c/ftmplt/kVSErrorKey //apple_ref/c/defn/kVSErrorKey //apple_ref/c/macro/kVSErrorKey //apple_ref/doc/com/intfm/kVSErrorKey" --><span class="preprocessor">kVSErrorKey</span><!-- /a --><span class="preprocessor"> </span><span class="preprocessor">"</span><!-- a logicalPath="//apple_ref/c/cl/com //apple_ref/c/tdef/com //apple_ref/c/tag/com //apple_ref/c/econst/com //apple_ref/c/struct/com //apple_ref/c/data/com //apple_ref/c/clconst/com //apple_ref/c/intf/com //apple_ref/c/instm/com //apple_ref/c/clm/com //apple_ref/c/intfcm/com //apple_ref/c/intfm/com //apple_ref/c/func/com //apple_ref/c/ftmplt/com //apple_ref/c/defn/com //apple_ref/c/macro/com //apple_ref/doc/com/intfm/com" --><span class="preprocessor">com</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/markdouma //apple_ref/c/tdef/markdouma //apple_ref/c/tag/markdouma //apple_ref/c/econst/markdouma //apple_ref/c/struct/markdouma //apple_ref/c/data/markdouma //apple_ref/c/clconst/markdouma //apple_ref/c/intf/markdouma //apple_ref/c/instm/markdouma //apple_ref/c/clm/markdouma //apple_ref/c/intfcm/markdouma //apple_ref/c/intfm/markdouma //apple_ref/c/func/markdouma //apple_ref/c/ftmplt/markdouma //apple_ref/c/defn/markdouma //apple_ref/c/macro/markdouma //apple_ref/doc/com/intfm/markdouma" --><span class="preprocessor">markdouma</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/SourceFinagler //apple_ref/c/tdef/SourceFinagler //apple_ref/c/tag/SourceFinagler //apple_ref/c/econst/SourceFinagler //apple_ref/c/struct/SourceFinagler //apple_ref/c/data/SourceFinagler //apple_ref/c/clconst/SourceFinagler //apple_ref/c/intf/SourceFinagler //apple_ref/c/instm/SourceFinagler //apple_ref/c/clm/SourceFinagler //apple_ref/c/intfcm/SourceFinagler //apple_ref/c/intfm/SourceFinagler //apple_ref/c/func/SourceFinagler //apple_ref/c/ftmplt/SourceFinagler //apple_ref/c/defn/SourceFinagler //apple_ref/c/macro/SourceFinagler //apple_ref/doc/com/intfm/SourceFinagler" --><span class="preprocessor">SourceFinagler</span><!-- /a --><span class="preprocessor">.</span><!-- a logicalPath="//apple_ref/c/cl/error //apple_ref/c/tdef/error //apple_ref/c/tag/error //apple_ref/c/econst/error //apple_ref/c/struct/error //apple_ref/c/data/error //apple_ref/c/clconst/error //apple_ref/c/intf/error //apple_ref/c/instm/error //apple_ref/c/clm/error //apple_ref/c/intfcm/error //apple_ref/c/intfm/error //apple_ref/c/func/error //apple_ref/c/ftmplt/error //apple_ref/c/defn/error //apple_ref/c/macro/error //apple_ref/doc/com/intfm/error" --><span class="preprocessor">error</span><!-- /a --><span class="preprocessor">"</span><span class="preprocessor"> </span><span class="comment"><span class="comment">//</span><span class="comment"></span><span class="comment"> </span><span class="comment">CFNumber</span></span>  </pre>
</div>
<h5 class="tight"><font face="Lucida Grande,Helvetica,Arial">Discussion</font>
</h5><!-- begin discussion --><p>Within a response, this key must reference a number that is the error result 
for the response, interpreted as an OSStatus.
<!-- end discussion -->
<p></p><p>Last Updated: Friday, August 27, 2010
</p></body></html>
